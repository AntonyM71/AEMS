# Autogenerated Endpoints Tests

This directory contains tests for the autogenerated CRUD endpoints. The tests are organized into several layers:

## 1. Basic Route Tests

`test_autogen_endpoints.py` and `test_autogen_minimal.py` verify that the routes exist and have the expected configuration.

These tests don't require a database connection and simply check that the routes are properly defined with the right prefixes and methods.

## 2. UUID Compatibility Tests

`test_uuid_compatibility.py` specifically tests UUID handling compatibility between PostgreSQL and SQLite.

This is important because:

- PostgreSQL has a native UUID type
- SQLite doesn't have a native UUID type and uses strings
- Our tests run with SQLite but the production system uses PostgreSQL

## 3. HTTP Tests with Mocked Database

`test_basic_http.py` and `test_endpoints_with_http.py` test the HTTP interaction with the routes while mocking the database dependency.

These tests verify that:

- The routes handle requests correctly
- The response structure matches what's expected
- The database is properly queried

## 4. Database Model Tests with SQLite UUID Compatibility

`test_model_helpers.py` provides utilities for testing with SQLite while simulating PostgreSQL UUID behavior.

The module includes:

- Custom `SqliteUUID` type that works like PostgreSQL UUID but is SQLite-compatible
- In-memory database session creation for testing
- Test model definitions that mirror the actual models but use SQLite types

## Using the Tests

### Basic Approach

Simply run the tests with pytest:

```bash
pytest app/tests/
```

### Focused Testing

To test just the basic route configuration:

```bash
pytest app/tests/test_autogen_minimal.py
```

To test the HTTP interaction:

```bash
pytest app/tests/test_basic_http.py
```

### UUID Compatibility

If migrating between database systems or changing UUID handling, run:

```bash
pytest app/tests/test_uuid_compatibility.py
```

## Extending the Tests

When adding new routes to `autogenEndpoints.py`:

1. Add basic route tests to `test_autogen_minimal.py`
2. Add HTTP tests with mocked database to `test_basic_http.py`
3. Update test models in `test_model_helpers.py` if needed
